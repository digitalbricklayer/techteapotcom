Date: Wed, 17 Feb 1999 18:47:20 +1100
From: "Tony-Farr (Canberra)" <Tony.Farr@austrade.gov.au>

This script extracts summary figures from the MRTG log files. In particular
it summarises all sites (i.e. as many as will fit on a page) into a single
Excel chart.

The summary is placed in an Excel spreadsheet & chart. The Excel worksheet
will have the same name as this program & be placed in the MRTG log file
directory.

I wrote this to summarise ping round trip times as generated by 
"mrtg-ping-probe". However it will process any mrtg log file. Some formatting
type stuff would need to be changed though if it were to be used for things
other than ping response times.

If, like us, you use PWS/IIS & IE, you can just link to the spreadsheet and
read it with IE.

A trap for novices:
If you have problems running Excel from "at", it's probably because of a
bug/limitation in "at". The problem is that regardless of which user submits
the job, it gets executed by the "system" user. (Great security, huh?) However
Excel probably isn't installed for the user "system". I changed the schedule
service to run as me rather than "system".

Args are:
	h	help
	d,w,m	do stats for last day, week or month
	f	directory containing mrtg log files

For example, once a week I run a CMD file that includes:

perl c:\perl\mrtg\contrib\xlsummary\xlsummary.pl -w -f d:\www\mrtg\ping
del d:\www\mrtg\ping\weeksummary.xls
ren d:\www\mrtg\ping\xlsummary.xls weeksummary.xls


Feel free to contact me regarding bugs.
Tony.Farr@austrade.gov.au
